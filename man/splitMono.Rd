% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/splitMono.R
\name{splitMono}
\alias{splitMono}
\title{split age groups using a monotonic spline}
\usage{
splitMono(Value, Age, OAG = FALSE)
}
\arguments{
\item{Value}{numeric vector of counts in age groups}

\item{Age}{integer vector of lower bound of age groups}

\item{OAG}{logical (default \code{FALSE}). Would we like to re-impute the last 
element of \code{Value} as the open age group?}
}
\value{
numeric vector of single age counts
}
\description{
Take the cumulative sum of \code{Value} and then run a monotonic spline through it. The first 
differences split back single-age estimates of \code{Value}. Optionally keep the open age group untouched.
}
\details{
We use the \code{"monoH.FC"} method of \code{stats::splinefun()} to fit the spline because 1)
it passes exactly through the points, 2) it is monotonic and therefore guarantees positive counts, and 3) 
it seems to be a bit less wiggly (lower average first differences of split counts) than a pchip tends to do, 
at least in the tested data. Data may be given in single or grouped ages.
}
\examples{
Value <- structure(c(88623, 90842, 93439, 96325, 99281, 102051, 104351, 
			 106555, 109170, 112188, 113582, 112614, 108904, 102622, 95867, 
			 80874, 60196, 37523, 17927, 5642, 1110), .Names = c("0", "5", 
			 "10", "15", "20", "25", "30", "35", "40", "45", "50", "55", "60", 
			 "65", "70", "75", "80", "85", "90", "95", "100"))

# overwrite open age group with a single age estimate for that age
# (doesn't extrapolate)
splitMono(Value)
# or respect open age group
splitMono(Value, OAG = TRUE)

# Also accepts single ages:
Value <- structure(c(9544406, 7471790, 11590109, 11881844, 11872503, 12968350, 
		11993151, 10033918, 14312222, 8111523, 15311047, 6861510, 13305117, 
		7454575, 9015381, 10325432, 9055588, 5519173, 12546779, 4784102, 
		13365429, 4630254, 9595545, 4727963, 5195032, 15061479, 5467392, 
		4011539, 8033850, 1972327, 17396266, 1647397, 6539557, 2233521, 
		2101024, 16768198, 3211834, 1923169, 4472854, 1182245, 15874081, 
		1017752, 3673865, 1247304, 1029243, 12619050, 1499847, 1250321, 
		2862148, 723195, 12396632, 733501, 2186678, 777379, 810700, 7298270, 
		1116032, 650402, 1465209, 411834, 9478824, 429296, 1190060, 446290, 
		362767, 4998209, 388753, 334629, 593906, 178133, 4560342, 179460, 
		481230, 159087, 155831, 1606147, 166763, 93569, 182238, 53567, 
		1715697, 127486, 150782, 52332, 48664, 456387, 46978, 34448, 
		44015, 19172, 329149, 48004, 28574, 9200, 7003, 75195, 13140, 
		5889, 18915, 21221, 72373), .Names = 0:100)
 
 from_single  <- splitMono(Value, OAG = TRUE) 
 # compare, had we pre-grouped ages:
 Val5         <- groupAges(Value, N=5, shiftdown = 0)
 from_grouped <- splitMono(Val5, OAG = TRUE)
 # de facto unit test:
 stopifnot(all(from_single == from_grouped))
}
\references{
\insertRef{fritsch1980monotone}{DemoTools}
}
